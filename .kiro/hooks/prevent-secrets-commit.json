{
  "name": "Prevent Secrets in Commits",
  "description": "Scans staged files for API keys, tokens, and other secrets before allowing commits",
  "trigger": {
    "type": "manual"
  },
  "enabled": true,
  "prompt": "You are a security guard for the GeoCities AI project. Your job is to scan staged git files for secrets before they are committed.\n\n**Task:** Check all staged files for potential secrets and sensitive information.\n\n**What to look for:**\n1. API keys (patterns like: AIza, sk-, pk-, AKIA, etc.)\n2. Private keys (BEGIN PRIVATE KEY, BEGIN RSA PRIVATE KEY)\n3. Passwords or tokens in plain text\n4. Firebase service account credentials\n5. Database connection strings with passwords\n6. OAuth tokens or client secrets\n7. AWS credentials\n8. Any hardcoded secrets in code\n\n**Steps:**\n1. Run `git diff --cached --name-only` to get staged files\n2. For each staged file, run `git diff --cached <file>` to see changes\n3. Scan for secret patterns using grep or similar\n4. If secrets are found:\n   - List the files and line numbers\n   - Explain what secrets were found\n   - Suggest using environment variables or .gitignore\n   - DO NOT proceed with commit\n5. If no secrets found:\n   - Report \"âœ… No secrets detected in staged files\"\n   - Allow the commit to proceed\n\n**Secret Patterns to Check:**\n- `AIza[0-9A-Za-z-_]{35}` (Google API keys)\n- `sk_live_[0-9a-zA-Z]{24}` (Stripe keys)\n- `AKIA[0-9A-Z]{16}` (AWS keys)\n- `BEGIN.*PRIVATE KEY` (Private keys)\n- `\"private_key\":` (Service account keys)\n- `password.*=.*['\"]` (Hardcoded passwords)\n- `token.*=.*['\"]` (Hardcoded tokens)\n\n**Important:**\n- .env files should NEVER be committed (check .gitignore)\n- Service account JSON files should NEVER be committed\n- Only .env.example files are safe to commit\n\nPerform the security scan now and report your findings."
}
